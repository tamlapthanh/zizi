<!DOCTYPE html>
<html lang="en"> <!--begin::Head-->

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Zizi Web App</title><!--begin::Primary Meta Tags-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="title" content="Zizi Web App | Dashboard">
    <meta name="author" content="ColorlibHQ">
    <meta name="description" content="Zizi Web App">
    <meta name="keywords" content="Zizi Web App"><!--end::Primary Meta Tags--><!--begin::Fonts-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fontsource/source-sans-3@5.0.12/index.css" integrity="sha256-tXJfXfp6Ewt1ilPzLDtQnJV4hclT9XuaZUKyUvmyr+Q=" crossorigin="anonymous"><!--end::Fonts--><!--begin::Third Party Plugin(OverlayScrollbars)-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/overlayscrollbars@2.3.0/styles/overlayscrollbars.min.css" integrity="sha256-dSokZseQNT08wYEWiz5iLI8QPlKxG+TswNRD8k35cpg=" crossorigin="anonymous"><!--end::Third Party Plugin(OverlayScrollbars)--><!--begin::Third Party Plugin(Bootstrap Icons)-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.min.css" integrity="sha256-Qsx5lrStHZyR9REqhUF8iQt73X06c8LGIUPzpOhwRrI=" crossorigin="anonymous"><!--end::Third Party Plugin(Bootstrap Icons)--><!--begin::Required Plugin(AdminLTE)-->
    <link rel="stylesheet" href="css/adminlte.css"><!--end::Required Plugin(AdminLTE)--><!-- apexcharts -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/apexcharts@3.37.1/dist/apexcharts.css" integrity="sha256-4MX+61mt9NVvvuPjUWdUdyfZfxSB1/Rf9WtqRHgG5S0=" crossorigin="anonymous"><!-- jsvectormap -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jsvectormap@1.5.3/dist/css/jsvectormap.min.css" integrity="sha256-+uGLJmmTKOqBr+2E6KDYs/NRsHxSkONXFHUL0fy2O/4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <style>
        .modal-footer {
            display: flex;
            justify-content: center;
            padding: 0;
            margin: 0;
        }
        .modal-footer .btn {
            margin: 0;
            padding: 0.375rem 0.75rem; /* Bootstrap's default button padding */
        }
    </style>

</head> <!--end::Head--> <!--begin::Body-->

<body class="layout-fixed sidebar-expand-lg bg-body-tertiary"> <!--begin::App Wrapper-->

    <div class="modal fade" id="videoModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" >
        <div class="modal-dialog modal-dialog-centered" style="width: 65%;" role="document">
        <div class="modal-content" >
            <div class="modal-body"  >
                <iframe width="100%" height="450" src="" frameborder="1"  allowfullscreen></iframe>
            </div>
        </div>
        </div>
    </div>

    <div class="app-wrapper"> <!--begin::Header-->
        <nav class="app-header navbar navbar-expand bg-body"> <!--begin::Container-->
            <div class="container-fluid"> <!--begin::Start Navbar Links-->
                <ul class="navbar-nav">
                    <li class="nav-item"> <a class="nav-link" data-lte-toggle="sidebar" href="#" role="button"> <i class="bi bi-list"></i> </a> </li>
                    <li class="nav-item d-none d-lg-block d-xl-block"> <a href="#" class="nav-link text-primary item_menu_class " ref_data="bai_hoc">Bài học </a> </li>
                    <li class="nav-item d-none d-lg-block d-xl-block"> <a href="#" class="nav-link item_menu_class  " ref_data="lop_hoc">Lớp học</i></a> </li>
                    <li class="nav-item d-none d-lg-block d-xl-block"> <a href="#" class="nav-link item_menu_class " ref_data="nop_bai">Nộp bài</a> </li>

                    <li class="nav-item d-lg-none d-xl-none"> <a href="#" class="nav-link text-primary item_menu_class " ref_data="bai_hoc"><i class="nav-icon bi bi-table"></i></a> </li>
                    <li class="nav-item d-lg-none d-xl-none"> <a href="#" class="nav-link item_menu_class  " ref_data="lop_hoc"><i class="nav-icon bi-box-seam-fill "></i></a> </li>
                    <li class="nav-item d-lg-none d-xl-none"> <a href="#" class="nav-link item_menu_class " ref_data="nop_bai"><i class="nav-icon bi bi-pencil-square "></i></a> </li>
                </ul> <!--end::Start Navbar Links--> <!--begin::End Navbar Links-->
                <ul class="navbar-nav ms-auto"> <!--begin::Navbar Search-->
                    <li class="nav-item"> <a class="nav-link" href="#" data-lte-toggle="fullscreen"> <i data-lte-icon="maximize" class="bi bi-arrows-fullscreen"></i> <i data-lte-icon="minimize" class="bi bi-fullscreen-exit" style="display: none;"></i> </a> </li> <!--end::Fullscreen Toggle--> <!--begin::User Menu Dropdown-->
                    <li class="nav-item dropdown user-menu"> <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown"> <img src="assets/img/Vy_user.png" class="user-image rounded-circle shadow" alt="User Image"> <span class="d-none d-md-inline">Viannce</span> </a>
                        <ul class="dropdown-menu dropdown-menu-lg dropdown-menu-end"> <!--begin::User Image-->
                            <li class="user-header text-bg-primary"> <img src="assets/img/Vy_user.png" class="rounded-circle shadow" alt="User Image">
                                <p>
                                    Viannce
                                </p>
                            </li> <!--end::User Image--> <!--begin::Menu Body-->
                            <li class="user-footer">  <a href="#" class="btn btn-default btn-flat float-end">Sign out</a> </li> <!--end::Menu Footer-->
                        </ul>
                    </li> <!--end::User Menu Dropdown-->
                </ul> <!--end::End Navbar Links-->
            </div> <!--end::Container-->
        </nav> <!--end::Header--> <!--begin::Sidebar-->
        <aside class="app-sidebar bg-body-secondary shadow" data-bs-theme="auto"> <!--begin::Sidebar Brand-->
            <div class="sidebar-brand"> <!--begin::Brand Link--> <a href="./index.html" class="brand-link"> <!--begin::Brand Image--> <img src="assets/img/AdminLTELogo.png" alt="AdminLTE Logo" class="brand-image opacity-75 shadow"> <!--end::Brand Image--> <!--begin::Brand Text--> <span class="brand-text fw-light">Dashboard</span> <!--end::Brand Text--> </a> <!--end::Brand Link--> </div> <!--end::Sidebar Brand--> <!--begin::Sidebar Wrapper-->
            <div class="sidebar-wrapper">
                <nav class="mt-2"> <!--begin::Sidebar Menu-->
                    <ul class="nav sidebar-menu flex-column" data-lte-toggle="treeview" role="menu" data-accordion="false">
                        <li class="nav-header ">VIANNCE</li>
                        <li class="nav-item menu-open"> <a href="#" class="nav-link"> <i class="nav-icon bi bi-speedometer"></i>
                                <p>
                                    W2 Class
                                    <i class="nav-arrow bi bi-chevron-right"></i>
                                </p>
                            </a>
                            <ul class="nav nav-treeview">
                                <li class="nav-item"> <a href="#" class="nav-link menu_class active" ref_data="bai_hoc"> <i class="nav-icon bi bi-table"></i>
                                        <p>Bài Học</p>
                                    </a> </li> 
                                    <li class="nav-item"> <a href="#" class="nav-link menu_class " ref_data="lop_hoc"> <i class="nav-icon bi bi-box-seam-fill"></i>
                                        <p>Lớp học</p>
                                    </a> </li>
                                    <li class="nav-item"> <a href="#" class="nav-link menu_class" ref_data="nop_bai"> <i class="nav-icon bi bi-pencil-square"></i>
                                        <p>Nộp bài</p>
                                    </a> </li>
                            </ul>
                        </li>

                        <li class="nav-item"> <a href="#" class="nav-link"> <i class="nav-icon bi bi-ui-checks-grid"></i>
                            <p>
                                Book
                                <i class="nav-arrow bi bi-chevron-right"></i>
                            </p>
                        </a>
                        <ul class="nav nav-treeview">
                            <li class="nav-item"> <a href="#" class="nav-link menu_class" ref_data="Oxford_phonics_world"> <i class="nav-icon bi bi-filetype-js"></i>
                                    <p>Oxford phonics world 1</p>
                                </a> </li> 
                        </ul>
                    </li>

                    </ul> <!--end::Sidebar Menu-->
                </nav>
            </div> <!--end::Sidebar Wrapper-->
        </aside> <!--end::Sidebar--> <!--begin::App Main-->
        <main class="app-main"> <!--begin::App Content Header-->
            <div class="app-content-header"> <!--begin::Container-->
                <div class="container-fluid"> <!--begin::Row-->
                  
                </div> <!--end::Container-->
            </div> <!--end::App Content Header--> <!--begin::App Content-->
            <div class="app-content"> <!--begin::Container-->



                <div class="container-fluid"> <!--begin::Row-->
                    <div class="row  data_class" id="#data_class"> 


                        <div class="spinner-grow text-primary" role="status">
                            <span class="visually-hidden">Loading...</span>
                          </div>
                    </div> 

     
                    
                </div> <!--end::Container-->
            </div> <!--end::App Content-->
        </main> <!--end::App Main--> <!--begin::Footer-->

        
    </div> <!--end::App Wrapper--> <!--begin::Script--> <!--begin::Third Party Plugin(OverlayScrollbars)-->
    <script src="https://cdn.jsdelivr.net/npm/overlayscrollbars@2.3.0/browser/overlayscrollbars.browser.es6.min.js" integrity="sha256-H2VM7BKda+v2Z4+DRy69uknwxjyDRhszjXFhsL4gD3w=" crossorigin="anonymous"></script> <!--end::Third Party Plugin(OverlayScrollbars)--><!--begin::Required Plugin(popperjs for Bootstrap 5)-->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha256-whL0tQWoY1Ku1iskqPFvmZ+CHsvmRWx/PIoEvIeWh4I=" crossorigin="anonymous"></script> <!--end::Required Plugin(popperjs for Bootstrap 5)--><!--begin::Required Plugin(Bootstrap 5)-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js" integrity="sha256-YMa+wAM6QkVyz999odX7lPRxkoYAan8suedu4k2Zur8=" crossorigin="anonymous"></script> <!--end::Required Plugin(Bootstrap 5)--><!--begin::Required Plugin(AdminLTE)-->
    <script src="js/adminlte.js"></script> <!--end::Required Plugin(AdminLTE)--><!--begin::OverlayScrollbars Configure-->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.3.min.js" integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-csv/1.0.21/jquery.csv.min.js" integrity="sha512-Y8iWYJDo6HiTo5xtml1g4QqHtl/PO1w+dmUpQfQSOTqKNsMhExfyPN2ncNAe9JuJUSKzwK/b6oaNPop4MXzkwg=="  crossorigin="anonymous" referrerpolicy="no-referrer"></script> 
    <script src="js/moment-with-locales.min.js"></script>
    <script>

                var JSON_DATA ;
                const SELECTOR_SIDEBAR_WRAPPER = ".sidebar-wrapper";
                const Default = {
                    scrollbarTheme: "os-theme-light",
                    scrollbarAutoHide: "leave",
                    scrollbarClickScroll: true,
                };
                document.addEventListener("DOMContentLoaded", function() {
                    const sidebarWrapper = document.querySelector(SELECTOR_SIDEBAR_WRAPPER);
                    if (
                        sidebarWrapper &&
                        typeof OverlayScrollbarsGlobal?.OverlayScrollbars !== "undefined"
                    ) {
                        OverlayScrollbarsGlobal.OverlayScrollbars(sidebarWrapper, {
                            scrollbars: {
                                theme: Default.scrollbarTheme,
                                autoHide: Default.scrollbarAutoHide,
                                clickScroll: Default.scrollbarClickScroll,
                            },
                        });
                    }
                });

                function loadDataToDiv(json_data, tagName, data_type) {
                      moment.locale("vi");  
                      $("div").remove(".video");
                      $( ".spinner-grow" ).show();
                        jQuery(json_data).each(function(index, item){

                            if ( item.Full_Path.includes(data_type) &&  item.Type.includes("mp4")) {
                                var video_id = `https://drive.google.com/file/d/${item.ID}/preview`;
                                var thumbnail_id  =`https://drive.google.com/thumbnail?id=${item.ID}`;
                                var learn_day = moment(item.Date).format('llll'); 
                                var tooltip = item.Description;
                                var content =  item.Description != "NULL" ? item.Description : learn_day; 
    
                                var appendTag = `<div class="col-6 col-sm-6 col-md-2 video"   data-video="${video_id}" data-toggle="modal" data-target="#videoModal" >
                                                            <span class="d-none d-lg-block bg-warning">${content}</span>
                                                            <div class="info-box text-bg-primary" style="background-image: url('${thumbnail_id}'); background-size: cover; cursor: pointer;"> 
                                                                <div class="info-box-content" style="min-height: 215px;"> 
                                                                    <span class="info-box-text d-block d-lg-none label  label-primary">${content}</span> 
                                                                </div> <!-- /.info-box-content -->
                                                            </div> <!-- /.info-box -->
                                                        </div> <!-- /.col -->`;

                                $(tagName).append(appendTag);
                            } // end of if
                        }); // end of   jQuery

                        $( ".spinner-grow" ).hide();
                  } // end of function loadData

     $(function() {

                $('.menu_class, .item_menu_class').click(function() {

                    $('.item_menu_class').removeClass("active");
                    $('.menu_class').removeClass("active");
                    $(this).addClass("active");

                    if ($(this).hasClass('item_menu_class')) {
                        // Disable all buttons
                        $('.item_menu_class').removeClass("text-primary");
                        // Enable the clicked button
                        $(this).addClass("text-primary");
                    } 


                        var ref_data = $(this).attr('ref_data');
                        loadDataToDiv(JSON_DATA, ".data_class",  ref_data);
                });

                $(document).on("click", ".video", function(){
                    console.log(this);
                    var theModal = $(this).data("target"),
                    videoSRC = $(this).attr("data-video"),
                    videoSRCauto = videoSRC 
                    $(theModal + ' iframe').attr('src', videoSRCauto);
                    $(theModal + ' button.close').click(function () {
                        $(theModal + ' iframe').attr('src', videoSRC);
                    });
                });

               getDataFromGoogleSheet();
               
          }); // end of $(function() {


          async function getDataFromGoogleSheet() {
            $( ".spinner-grow" ).show();
            var url = "https://script.google.com/macros/s/AKfycbw6wLxFkPaRkuiiMykkNXnbha8caeXgCpFSUdpKDzfupkuWVE8qJrazbosQckpSm2Ctiw/exec";
            const response = await fetch(
              url + "?name=Sheet1"
            );
            //   console.log(response);
            JSON_DATA  = await response.json();
            $( ".spinner-grow" ).hide();
            loadDataToDiv(JSON_DATA, ".data_class",  "bai_hoc");
          }

    </script> <!--end::OverlayScrollbars Configure--> <!-- OPTIONAL SCRIPTS --> 

</body><!--end::Body-->

</html>